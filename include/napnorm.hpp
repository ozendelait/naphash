/******************************************************************************
*
* FILENAME:     napnorm.hpp
*
* PURPOSE:      Header for NAPHash/NPHash weights and indices
*               see https://github.com/ozendelait/naphash for more information
*               
* AUTHOR:       Oliver Zendel, AIT Austrian Institute of Technology GmbH
*
*  Copyright (C) 2021 AIT Austrian Institute of Technology GmbH
*  All rights reserved.
******************************************************************************/ 

static const int nap_norm_len              = 324; //maximum length of nap norm coeffs.
static const int naphash_pack_len          = 320; //maximum length of naphash bits
static const int naphash_nondiag_pack_len  = 312; //maximum length of naphash bits (non-diag.)

//zig-zag readout pattern for applying norm weights to square matrix of dct coeff
static const unsigned char naphash_idx0[nap_norm_len] = {0, 1, 0, 2, 1, 2, 0, 3, 1, 2, 1, 3, 0, 4, 2, 3, 1, 4, 0, 5, 2, 4, 1, 5, 0, 6, 3, 4, 2, 5, 1, 6, 0, 7, 3, 4, 3, 5, 2, 6, 1, 7, 0, 8, 4, 5, 3, 6, 2, 7, 1, 8, 0, 9, 4, 6, 3, 7, 2, 8, 1, 9, 0, 10, 5, 6, 4, 7, 3, 8, 2, 9, 1, 10, 0, 11, 5, 6, 5, 7, 4, 8, 3, 9, 2, 10, 1, 11, 0, 12, 6, 7, 5, 8, 4, 9, 3, 10, 2, 11, 1, 12, 0, 13, 6, 8, 5, 9, 4, 10, 3, 11, 2, 12, 1, 13, 0, 14, 7, 8, 6, 9, 5, 10, 4, 11, 3, 12, 2, 13, 1, 14, 0, 15, 7, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15, 0, 16, 8, 9, 7, 10, 6, 11, 5, 12, 4, 13, 3, 14, 2, 15, 1, 16, 0, 17, 8, 10, 7, 11, 6, 12, 5, 13, 4, 14, 3, 15, 2, 16, 1, 17, 0, 18, 9, 10, 8, 11, 7, 12, 6, 13, 5, 14, 4, 15, 3, 16, 2, 17, 1, 18, 0, 19, 9, 10, 9, 11, 8, 12, 7, 13, 6, 14, 5, 15, 4, 16, 3, 17, 2, 18, 1, 19, 0, 20, 10, 11, 9, 12, 8, 13, 7, 14, 6, 15, 5, 16, 4, 17, 3, 18, 2, 19, 1, 20, 0, 21, 10, 12, 9, 13, 8, 14, 7, 15, 6, 16, 5, 17, 4, 18, 3, 19, 2, 20, 1, 21, 0, 22, 11, 12, 10, 13, 9, 14, 8, 15, 7, 16, 6, 17, 5, 18, 4, 19, 3, 20, 2, 21, 1, 22, 0, 23, 11, 12, 11, 13, 10, 14, 9, 15, 8, 16, 7, 17, 6, 18, 5, 19, 4, 20, 3, 21, 2, 22, 1, 23, 0, 24};

static const unsigned char naphash_idx1[nap_norm_len] = {1, 0, 2, 0, 2, 1, 3, 0, 1, 2, 3, 1, 4, 0, 3, 2, 4, 1, 5, 0, 4, 2, 5, 1, 6, 0, 4, 3, 5, 2, 6, 1, 7, 0, 3, 4, 5, 3, 6, 2, 7, 1, 8, 0, 5, 4, 6, 3, 7, 2, 8, 1, 9, 0, 6, 4, 7, 3, 8, 2, 9, 1, 10, 0, 6, 5, 7, 4, 8, 3, 9, 2, 10, 1, 11, 0, 5, 6, 7, 5, 8, 4, 9, 3, 10, 2, 11, 1, 12, 0, 7, 6, 8, 5, 9, 4, 10, 3, 11, 2, 12, 1, 13, 0, 8, 6, 9, 5, 10, 4, 11, 3, 12, 2, 13, 1, 14, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15, 0, 7, 8, 9, 7, 10, 6, 11, 5, 12, 4, 13, 3, 14, 2, 15, 1, 16, 0, 9, 8, 10, 7, 11, 6, 12, 5, 13, 4, 14, 3, 15, 2, 16, 1, 17, 0, 10, 8, 11, 7, 12, 6, 13, 5, 14, 4, 15, 3, 16, 2, 17, 1, 18, 0, 10, 9, 11, 8, 12, 7, 13, 6, 14, 5, 15, 4, 16, 3, 17, 2, 18, 1, 19, 0, 9, 10, 11, 9, 12, 8, 13, 7, 14, 6, 15, 5, 16, 4, 17, 3, 18, 2, 19, 1, 20, 0, 11, 10, 12, 9, 13, 8, 14, 7, 15, 6, 16, 5, 17, 4, 18, 3, 19, 2, 20, 1, 21, 0, 12, 10, 13, 9, 14, 8, 15, 7, 16, 6, 17, 5, 18, 4, 19, 3, 20, 2, 21, 1, 22, 0, 12, 11, 13, 10, 14, 9, 15, 8, 16, 7, 17, 6, 18, 5, 19, 4, 20, 3, 21, 2, 22, 1, 23, 0, 11, 12, 13, 11, 14, 10, 15, 9, 16, 8, 17, 7, 18, 6, 19, 5, 20, 4, 21, 3, 22, 2, 23, 1, 24, 0};

//norm weight index corresponding to transposed position in dct coeff matrix
static const unsigned int naphash_idx_tr[nap_norm_len] = {1, 0, 3, 2, 5, 4, 7, 6, 8, 9, 11, 10, 13, 12, 15, 14, 17, 16, 19, 18, 21, 20, 23, 22, 25, 24, 27, 26, 29, 28, 31, 30, 33, 32, 34, 35, 37, 36, 39, 38, 41, 40, 43, 42, 45, 44, 47, 46, 49, 48, 51, 50, 53, 52, 55, 54, 57, 56, 59, 58, 61, 60, 63, 62, 65, 64, 67, 66, 69, 68, 71, 70, 73, 72, 75, 74, 76, 77, 79, 78, 81, 80, 83, 82, 85, 84, 87, 86, 89, 88, 91, 90, 93, 92, 95, 94, 97, 96, 99, 98, 101, 100, 103, 102, 105, 104, 107, 106, 109, 108, 111, 110, 113, 112, 115, 114, 117, 116, 119, 118, 121, 120, 123, 122, 125, 124, 127, 126, 129, 128, 131, 130, 133, 132, 134, 135, 137, 136, 139, 138, 141, 140, 143, 142, 145, 144, 147, 146, 149, 148, 151, 150, 153, 152, 155, 154, 157, 156, 159, 158, 161, 160, 163, 162, 165, 164, 167, 166, 169, 168, 171, 170, 173, 172, 175, 174, 177, 176, 179, 178, 181, 180, 183, 182, 185, 184, 187, 186, 189, 188, 191, 190, 193, 192, 195, 194, 197, 196, 199, 198, 201, 200, 203, 202, 205, 204, 207, 206, 208, 209, 211, 210, 213, 212, 215, 214, 217, 216, 219, 218, 221, 220, 223, 222, 225, 224, 227, 226, 229, 228, 231, 230, 233, 232, 235, 234, 237, 236, 239, 238, 241, 240, 243, 242, 245, 244, 247, 246, 249, 248, 251, 250, 253, 252, 255, 254, 257, 256, 259, 258, 261, 260, 263, 262, 265, 264, 267, 266, 269, 268, 271, 270, 273, 272, 275, 274, 277, 276, 279, 278, 281, 280, 283, 282, 285, 284, 287, 286, 289, 288, 291, 290, 293, 292, 295, 294, 297, 296, 298, 299, 301, 300, 303, 302, 305, 304, 307, 306, 309, 308, 311, 310, 313, 312, 315, 314, 317, 316, 319, 318, 321, 320, 323, 322};

//indices for packing results (max. number is 320)
static const unsigned int naphash_pack_idx[naphash_pack_len] = {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319};

//indices for packing results without diagonal indices (max. number is 312)
static const unsigned int naphash_pack_nondiag_idx[naphash_nondiag_pack_len] = {0, 1, 2, 3, 4, 5, 6, 7, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323};

static const float naphash_norm[nap_norm_len] = {421,  256,  317,  352,  642,  832,  703,  590,  657,  603,  992,
       1051,  659,  744, 1059,  909, 1159, 1353, 1180,  960, 1061, 1043,
       1602, 1560, 1176, 1109, 1284, 1556, 1484, 1347, 1695, 1823, 1616,
       1207, 1340, 1448, 1724, 1842, 1474, 1495, 2062, 2096, 1617, 1533,
       1908, 1751, 1720, 2079, 1893, 1568, 2179, 2364, 2036, 1744, 1926,
       1949, 2126, 2334, 1929, 1946, 2590, 2655, 2017, 1917, 2163, 2430,
       2355, 2155, 2170, 2593, 2349, 2162, 2730, 2964, 2467, 2151, 2205,
       2306, 2588, 2721, 2278, 2469, 2564, 2902, 2307, 2334, 3109, 3263,
       2513, 2445, 2875, 2682, 2610, 2966, 2803, 2711, 2665, 3244, 2799,
       2571, 3276, 3526, 2933, 2564, 2758, 2907, 3055, 3262, 2805, 2957,
       3026, 3424, 2857, 2870, 3683, 3870, 3012, 2950, 3102, 3421, 3304,
       3008, 3148, 3532, 3247, 3235, 3171, 3704, 3229, 2947, 3860, 4137,
       3445, 3196, 3191, 3356, 3578, 3667, 3346, 3349, 3562, 3830, 3355,
       3429, 3560, 3970, 3403, 3397, 4275, 4453, 3583, 3399, 3853, 3493,
       3563, 3941, 3744, 3616, 3611, 4096, 3694, 3677, 3686, 4310, 3797,
       3619, 4487, 4812, 4007, 3758, 3878, 3794, 4062, 4239, 3842, 3899,
       4018, 4374, 3837, 4008, 4111, 4576, 3968, 3880, 4948, 5125, 4095,
       3945, 4120, 4365, 4319, 4138, 4087, 4523, 4237, 4227, 4172, 4729,
       4269, 4305, 4278, 4941, 4396, 4219, 5206, 5526, 4708, 4363, 4090,
       4423, 4585, 4685, 4382, 4387, 4540, 4825, 4351, 4514, 4537, 5045,
       4334, 4604, 4654, 5261, 4521, 4450, 5771, 5905, 4794, 4568, 4913,
       4677, 4663, 4974, 4817, 4683, 4644, 5139, 4741, 4744, 4713, 5348,
       4831, 4909, 4905, 5605, 5083, 4832, 6056, 6373, 5339, 5011, 4905,
       4939, 5113, 5264, 4885, 4991, 5100, 5457, 4883, 5135, 5138, 5688,
       4972, 5188, 5353, 6008, 5342, 5051, 6630, 6806, 5635, 5314, 5232,
       5460, 5412, 5188, 5240, 5633, 5355, 5241, 5225, 5779, 5380, 5351,
       5379, 6069, 5518, 5459, 5610, 6414, 5788, 5518, 7043, 7368, 6290,
       5606, 5140, 5299, 5650, 5786, 5413, 5516, 5690, 5946, 5485, 5600,
       5653, 6295, 5522, 5779, 5817, 6435, 5745, 5937, 6138, 6875, 6106,
       5847, 7675, 7939, 6582, 6437};

static const float naphash_norm_crop[nap_norm_len] = {463,  256,  352,  344,  717,  862,  786,  591,  715,  611, 1110,
       1075,  736,  725, 1127,  943, 1200, 1368, 1222,  995, 1098, 1080,
       1621, 1615, 1217, 1148, 1329, 1611, 1536, 1395, 1716, 1887, 1636,
       1250, 1388, 1499, 1785, 1907, 1526, 1547, 2135, 2171, 1674, 1588,
       1974, 1812, 1781, 2153, 1960, 1623, 2256, 2448, 2108, 1805, 1995,
       2017, 2201, 2416, 1997, 2015, 2680, 2750, 2089, 1986, 2240, 2515,
       2438, 2231, 2245, 2684, 2432, 2239, 2827, 3070, 2555, 2227, 2283,
       2387, 2679, 2818, 2357, 2557, 2653, 3005, 2388, 2417, 3218, 3378,
       2601, 2532, 2976, 2778, 2701, 3072, 2902, 2808, 2758, 3281, 2898,
       2662, 3392, 3652, 3037, 2656, 2855, 3010, 3164, 3378, 2904, 3061,
       3133, 3548, 2957, 2973, 3813, 3977, 3118, 3055, 3149, 3541, 3420,
       3112, 3259, 3657, 3363, 3348, 3283, 3836, 3344, 3051, 3996, 4284,
       3566, 3310, 3238, 3475, 3705, 3797, 3464, 3467, 3688, 3966, 3473,
       3550, 3686, 4110, 3523, 3518, 4424, 4612, 3710, 3520, 3988, 3615,
       3688, 4082, 3876, 3743, 3738, 4241, 3824, 3807, 3817, 4463, 3930,
       3748, 4643, 4983, 4148, 3892, 4013, 3929, 4203, 4389, 3977, 4036,
       4159, 4527, 3971, 4149, 4238, 4739, 4108, 4018, 5123, 5307, 4239,
       4085, 4266, 4520, 4472, 4284, 4230, 4681, 4385, 4376, 4302, 4896,
       4420, 4457, 4428, 5115, 4551, 4367, 5391, 5722, 4874, 4519, 4234,
       4581, 4749, 4851, 4535, 4542, 4700, 4994, 4504, 4673, 4696, 5221,
       4487, 4768, 4817, 5448, 4678, 4605, 5976, 6117, 4963, 4731, 5086,
       4841, 4829, 5147, 4987, 4848, 4808, 5323, 4908, 4912, 4878, 5537,
       4980, 5083, 5078, 5803, 5262, 5004, 6244, 6599, 5527, 5190, 5075,
       5008, 5294, 5448, 5058, 5151, 5281, 5650, 5055, 5297, 5320, 5892,
       5145, 5371, 5543, 6221, 5412, 5229, 6866, 7048, 5834, 5504, 5417,
       5652, 5604, 5374, 5404, 5831, 5544, 5405, 5410, 5982, 5571, 5540,
       5568, 6283, 5711, 5651, 5807, 6640, 5991, 5715, 7294, 7630, 6512,
       5806, 5321, 5486, 5847, 5990, 5602, 5712, 5892, 6154, 5677, 5797,
       5852, 6373, 5717, 5985, 6021, 6665, 5950, 6148, 6357, 7117, 6322,
       6054, 7950, 8220, 6812, 6498};

static const float naphash_norm_rotinv[nap_norm_len] = { 462,  256,  352,  344,  717,  941,  786,  590,  715,  667, 1110,
       1173,  736,  725, 1127,  943, 1169, 1332, 1190,  969, 1069, 1052,
       1578, 1715, 1294, 1119, 1294, 1569, 1496, 1359, 1671, 1837, 1594,
       1218, 1352, 1593, 1737, 2026, 1486, 1507, 2078, 2113, 1629, 1688,
       1923, 1766, 1892, 2096, 1909, 1582, 2198, 2382, 2053, 1919, 1943,
       1966, 2143, 2568, 1945, 1962, 2610, 2675, 2034, 1934, 2381, 2448,
       2374, 2371, 2186, 2851, 2368, 2180, 3004, 2988, 2713, 2169, 2222,
       2324, 2608, 2744, 2295, 2489, 2635, 2923, 2536, 2352, 3134, 3288,
       2763, 2465, 2898, 2705, 2632, 2991, 2826, 2734, 2686, 3195, 3078,
       2592, 3304, 3553, 2956, 2586, 2779, 2931, 3080, 3288, 2828, 2981,
       3051, 3451, 2880, 3158, 3710, 4227, 3037, 2974, 3066, 3447, 3634,
       3031, 3173, 3560, 3273, 3258, 3488, 3731, 3255, 2971, 3891, 4171,
       3470, 3221, 3152, 3385, 3934, 3697, 3373, 3377, 3589, 3862, 3382,
       3773, 3589, 4366, 3429, 3736, 4305, 4898, 3614, 3426, 3955, 3843,
       3592, 3973, 4118, 3647, 3639, 4128, 3724, 3708, 3716, 4344, 3827,
       3647, 4522, 4849, 4041, 3788, 3908, 3824, 4094, 4274, 3871, 3928,
       4050, 4408, 4221, 4041, 4125, 4613, 4001, 4268, 4986, 5162, 4128,
       3976, 4153, 4402, 4353, 4168, 4118, 4559, 4270, 4261, 4189, 4767,
       4302, 4340, 4704, 4978, 4431, 4253, 5251, 6073, 4745, 4398, 4121,
       4462, 5043, 4723, 4819, 4422, 4578, 4861, 4785, 4550, 4573, 5085,
       4369, 4727, 4688, 5301, 4554, 4482, 5814, 5949, 4832, 4604, 4954,
       4714, 4703, 5014, 4855, 4720, 4682, 5181, 4779, 4781, 4748, 5879,
       4941, 4948, 5389, 5646, 5122, 5315, 6080, 6422, 5379, 5052, 4945,
       4874, 5626, 5305, 4924, 5017, 5139, 5501, 4922, 5629, 5181, 5737,
       5009, 5229, 5399, 6055, 5268, 5089, 6684, 6859, 5680, 5354, 5274,
       5504, 5457, 5229, 5259, 5677, 5889, 5261, 5269, 5825, 5917, 5394,
       5422, 6113, 5560, 5503, 5654, 6462, 5834, 5562, 7096, 7419, 6339,
       5654, 5181, 5342, 5695, 5830, 5456, 5563, 6258, 6540, 5530, 5644,
       5697, 6201, 5567, 5822, 5862, 6490, 5793, 5985, 6181, 6926, 6719,
       5894, 7738, 7999, 6631, 6318};

